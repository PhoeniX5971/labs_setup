# Additional Scripts for PowerShell AD Toolkit

This document lists PowerShell modules and commands finalized today, ready for inclusion or use alongside the main AD toolkit.

---

## Newly Finished Scripts

### adcs_esc10_add_weak_certificate_mapping.ps1

Adds weak certificate mapping for AD CS ESC10 vulnerability, allowing certificate mapping abuse.

---

### adcs_esc11_disable_enforced_encryption.ps1

Disables enforced encryption requests on certificate templates (ADCS ESC11).

---

### enable_credssp_client.ps1

Enables CredSSP authentication on the client side for WinRM delegation.

---

### enable_credssp_server.ps1

Enables CredSSP authentication on the server side for WinRM delegation.

---

### enable_llmnr.ps1

Enables the Link-Local Multicast Name Resolution (LLMNR) protocol.

---

### enable_nbt_ns.ps1

Enables NetBIOS over TCP/IP Name Service (NBT-NS).

---

### enable_ntlm_downgrade.ps1

Configures the system to allow NTLM downgrade attacks by setting `LmCompatibilityLevel`.

---

### enable_smbv1.ps1

Installs and enables the SMBv1 protocol feature on the Windows machine.

---

## Example Usage

```powershell
# Add weak certificate mapping (ADCS ESC10)
.\adcs_esc10_add_weak_certificate_mapping.ps1 -UserIdentity "victim.user"

# Disable enforced encryption request (ADCS ESC11)
.\adcs_esc11_disable_enforced_encryption.ps1 -UserIdentity "victim.user"

# Enable CredSSP on client
.\enable_credssp_client.ps1

# Enable CredSSP on server
.\enable_credssp_server.ps1

# Enable LLMNR protocol
.\enable_llmnr.ps1

# Enable NetBIOS over TCP/IP Name Service
.\enable_nbt_ns.ps1

# Enable NTLM downgrade vulnerability
.\enable_ntlm_downgrade.ps1

# Enable SMBv1 protocol
.\enable_smbv1.ps1
```

---

## Notes

- These scripts require running PowerShell as Administrator.
- Some may require specific Windows features or modules (e.g., ActiveDirectory).
- Verify compatibility and domain-join status depending on the script.

---

---

## Untested Scripts (Pending Certificate Setup)

### adcs_esc13.ps1

Script to exploit certificate template vulnerabilities (ADCS ESC13).
**Note:** Requires certificates to be set up for proper testing.

---

### adcs_esc15.ps1

Automates abuse of certificate auto-enrollment (ADCS ESC15).
**Note:** Testing requires configured certificate templates and enrollment permissions.

---

### adcs_esc6.ps1

Handles custom certificate mapping abuse scenarios (ADCS ESC6).
**Note:** Requires relevant certificate environment for verification.

---

### adcs_esc7.ps1

Targets certificate template permissions abuse (ADCS ESC7).
**Note:** Setup of certificates and templates needed before testing.

---

## Notes

- These scripts are currently untested due to missing certificates or infrastructure.
- They will be revisited once the necessary certificate setup is available.

---
